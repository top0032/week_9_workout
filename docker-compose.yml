version: '3.8'

services:
  # 'web'이라는 이름의 서비스 하나만 실행 (Flask가 API와 웹 모두 담당)
  web:
    # 현재 폴더(.)의 Dockerfile을 사용하여 이미지 빌드
    build: .
    container_name: capstone-project
    restart: unless-stopped
    
    # 호스트(PC)의 8080 포트와 컨테이너의 5000번 포트 연결
    ports:
      - "5000:5000" 
      
    # (선택사항) 코드 수정 시 바로 반영되도록 현재 폴더를 컨테이너에 연결
    volumes:
      - .:/app
      
    # app.py가 0.0.0.0:5000 에서 실행되도록 환경 변수 설정
    environment:
      - FLASK_ENV=development
      - FLASK_APP=app.py
      - FLASK_RUN_HOST=0.0.0.0
      - FLASK_RUN_PORT=5000